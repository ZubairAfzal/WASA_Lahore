using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Script.Serialization;
using System.Web.Script.Services;
using System.Web.Services;
using WASA_EMS.Models;
using Newtonsoft.Json;
using DotImaging.Primitives2D;

namespace WASA_EMS
{
    /// <summary>
    /// Summary description for saveData
    /// </summary>
    /// FOR WASA TTLOGIX
    [WebService(Namespace = "http://wasalhr.ttlogix.com/")]
    /// FOR WASA AMAZON WEB SERVER
    //[WebService(Namespace = "http://http://35.166.74.72/")]
    /// FOR LOCALHOST
    //[WebService(Namespace = "http://localhost/")]


    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class saveData2 : System.Web.Services.WebService
    {
        public int c_id;
        [WebMethod]
        public string insertData(string code, string val, string time)
        {
            string Message;
            BAL bal = new BAL();
            int result = bal.saveData(code, val, time);
            if (result == 1)
            {
                Message = "Details are inserted successfully";
            }
            else
            {
                Message = "Details are not inserted successfully";
            }
            return Message;
        }

        [WebMethod]
        public string insertUpdateData(string code, string val, string time, string lat, string lng)
        {
            string Message;
            BAL bal = new BAL();
            int result = bal.saveData(code, val, time, lat, lng);
            if (result == 1)
            {
                Message = "Details are inserted successfully";
            }
            else
            {
                Message = "Details are not inserted successfully";
            }
            return Message;
        }
        [WebMethod]
        public string getScheduleTime()
        {
            BAL bal = new BAL();
            string ScheduleTime = bal.getScheduleTime();
            return ScheduleTime;
        }

        [WebMethod]
        public string execQuery(string query)
        {
            BAL bal = new BAL();
            string result = bal.execQuery(query);
            return result;
        }

        [WebMethod]
        public string GetData121()
        {
            int c_id = 4;
            List<object> lists = new List<object>();
            //int c_id = Convert.ToInt32(Session["CompanyID"]);
            string tempName = "";
            string query = "select TemplateID, TemplateName from tblTemplate where CompanyID = " + c_id + "";
            query += " and TemplateID in (select TemplateID from tblResource) ";
            List<SelectListItem> items = new List<SelectListItem>();
            using (SqlConnection con1 = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
                using (SqlCommand cmd2 = new SqlCommand(query))
                {
                    cmd2.Connection = con1;
                    con1.Open();
                    using (SqlDataReader sdr = cmd2.ExecuteReader())
                    {
                        while (sdr.Read())
                        {
                            items.Add(new SelectListItem
                            {
                                Text = sdr["TemplateName"].ToString(),
                                Value = sdr["TemplateID"].ToString()
                            });
                        }
                    }
                    con1.Close();
                }
            }
            string PG = "";
            string PL = "";
            string PF = "";
            string VM = "";
            string CL = "";
            string LS = "";
            string CT = "";
            string VT = "";
            string Auto = "";
            string Time = "";
            string Remote = "";
            string PGvaluee = "";
            string PFvaluee = "";
            string PLvaluee = "";
            string VMvaluee = "";
            string LSvaluee = "";
            string CLvaluee = "";

            string CTvaluee = "";
            string VTvaluee = "";
            string parameterValuesString = "";
            string datetimed = "";
            string markers = "[";
            WASA_EMS_Entities db = new WASA_EMS_Entities();
            string q = "select r.ResourceLocation, r.ResourceID, r.CooridatesGoogle, t.TemplateName from tblResource r left join tblTemplate t on r.TemplateID = t.TemplateID  where t.CompanyID = " + c_id + "";
            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
                try
                {
                    conn.Open();
                    SqlCommand cmd3 = new SqlCommand(q, conn);
                    using (SqlDataReader sdr = cmd3.ExecuteReader())
                    {
                        while (sdr.Read())
                        {
                            string q1 = "select distinct r.ResourceLocation,  t.TemplateName, p.ParameterName, e.ParameterValue, e.InsertionDateTime, rms.CurrentMotorOnOffStatus from tblEnergy e ";
                            q1 += "left join tblParameter p on e.ParameterID = p.ParameterID ";
                            q1 += "left join tblResource r on e.ResourceID = r.ResourceID ";
                            q1 += "left join tblRemoteSensor rms on r.ResourceID = rms.ResourceID ";
                            q1 += "left join tblTemplate t on r.TemplateID = t.TemplateID ";
                            q1 += "where e.InsertionDateTime = (select max(InsertionDateTime) from tblEnergy where ResourceID = " + sdr["ResourceID"] + ")";
                            q1 += "and r.ResourceID = " + sdr["ResourceID"] + "";
                            SqlCommand cmd1 = new SqlCommand(q1, conn);
                            int optionStatus = 0;
                            using (SqlDataReader sdr1 = cmd1.ExecuteReader())
                            {
                                while (sdr1.Read())
                                {
                                    string valuee = "";






                                    parameterValuesString += "";
                                    parameterValuesString += sdr1["ParameterName"].ToString() + ": ";

                                    if (sdr1["ParameterName"].ToString() == "Manual")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Auto = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Auto = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus1.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus2.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus3.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus4.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus5.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus6.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus7.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus8.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus9.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatuss10.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "CurrentTrip.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "No Error";
                                        }
                                        else
                                        {
                                            valuee = "Error";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "VoltageTrip.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "No Error";
                                        }
                                        else
                                        {
                                            valuee = "Error";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "Remote.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Remote = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Remote = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "TimeSchedule.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Time = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Time = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "Pressure(Bar)")
                                    {
                                        PGvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PF.")
                                    {
                                        PFvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PrimingLevel")
                                    {
                                        PLvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "vib_y")
                                    {
                                        VMvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "ChlorineLevel.")
                                    {
                                        CLvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "OutdoorLight")
                                    {
                                        LSvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "VoltageTrip.")
                                    {
                                        VTvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "CurrentTrip.")
                                    {
                                        CTvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else
                                    {
                                        valuee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }

                                    PG += PGvaluee;

                                    PF += PFvaluee;
                                    PL += PLvaluee;
                                    VM += VMvaluee;
                                    CL += CLvaluee;
                                    LS += LSvaluee;
                                    VT += VTvaluee;
                                    CT += CTvaluee;
                                    parameterValuesString += valuee;
                                    parameterValuesString += "<br />";
                                    datetimed = sdr1["InsertionDateTime"].ToString();
                                    //optionStatus = sdr1["CurrentMotorOnOffStatus"].ToString();
                                }
                            }
                            string theStatus = "False";
                            if (optionStatus > 0)
                            {
                                theStatus = "True";
                            }


                            tempName = sdr["TemplateName"].ToString().Substring(0, 1);

                            string newstring = "<b>" + sdr["TemplateName"].ToString() + "</b>";
                            newstring += "<br />";
                            newstring += "<b>" + sdr["ResourceLocation"].ToString() + "</b>";
                            newstring += "<br />";
                            newstring += datetimed;
                            newstring += "<br />";
                            newstring += parameterValuesString;

                            TimeSpan duration = (Convert.ToDateTime(TimeZoneInfo.ConvertTimeBySystemTimeZoneId(DateTime.UtcNow, "Pakistan Standard Time").ToString()) - Convert.ToDateTime(datetimed.ToString()));
                            double minu = duration.TotalMinutes;
                            parameterValuesString = "";

                            markers += "{";

                            markers += string.Format("'Auto': '{0}',", Auto);
                            markers += string.Format("'Remote': '{0}',", Remote);
                            markers += string.Format("'Time': '{0}',", Time);
                            markers += string.Format("'CT': '{0}',", CTvaluee);
                            markers += string.Format("'VT': '{0}',", VTvaluee);
                            markers += string.Format("'LS': '{0}',", LSvaluee);
                            markers += string.Format("'CL': '{0}',", CLvaluee);
                            markers += string.Format("'VM': '{0}',", PLvaluee);
                            markers += string.Format("'PF': '{0}',", PFvaluee);
                            markers += string.Format("'P': '{0}',", PGvaluee);
                            markers += string.Format("'PL': '{0}',", PLvaluee);
                            markers += string.Format("'Status': '{0}',", theStatus);
                            markers += string.Format("'Template': '{0}',", tempName);
                            markers += string.Format("'title': '{0}',", sdr["ResourceLocation"]);
                            markers += string.Format("'Dtae': '{0}',", datetimed);
                            //markers += string.Format("'time': '{0}',", sdr1["InsertionDateTime"]);
                            markers += string.Format("'lat':'{0}',", sdr["CooridatesGoogle"].ToString().Split(',')[0]);
                            markers += string.Format("'lnt':'{0}',", sdr["CooridatesGoogle"].ToString().Split(',')[1]);
                            //markers += string.Format("'parameter':'{0}',", sdr1["ParameterName"]);
                            //markers += string.Format("'value':'{0}'", sdr1["ParameterValue"]);
                            markers += string.Format("'DelTime': '{0}',", minu);
                            markers += string.Format("'description': '{0}'", newstring);
                            markers += "},";
                        }
                    }
                    conn.Close();
                }
                catch (Exception ex)
                {

                }
                //return new SelectList(theResourceTypes, "Value", "Text", "id");
            }

            markers += "]";
            return markers;
        }

        [WebMethod]
        public string GetDataDisposals()
        {
            int c_id = 4;
            List<object> lists = new List<object>();
            //int c_id = Convert.ToInt32(Session["CompanyID"]);
            string tempName = "";
            string query = "select TemplateID, TemplateName from tblTemplate where CompanyID = " + c_id + "";
            query += " and TemplateID in (select TemplateID from tblResource) ";
            List<SelectListItem> items = new List<SelectListItem>();
            using (SqlConnection con1 = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
                using (SqlCommand cmd2 = new SqlCommand(query))
                {
                    cmd2.Connection = con1;
                    con1.Open();
                    using (SqlDataReader sdr = cmd2.ExecuteReader())
                    {
                        while (sdr.Read())
                        {
                            items.Add(new SelectListItem
                            {
                                Text = sdr["TemplateName"].ToString(),
                                Value = sdr["TemplateID"].ToString()
                            });
                        }
                    }
                    con1.Close();
                }
            }
            string PG = "";
            string P1 = "";
            string P2 = "";
            string P3 = "";
            string P4 = "";
            string P5 = "";
            string P6 = "";
            string P7 = "";
            string P8 = "";
            string P9 = "";
            string P10 = "";
            string P1value = "";
            string P2value = "";
            string P3value = "";
            string P4value = "";
            string P5value = "";
            string P6value = "";
            string P7value = "";
            string P8value = "";
            string P9value = "";
            string P10value = "";
            string PL = "";
            string PF = "";
            string VM = "";
            string CL = "";
            string LS = "";
            string CT = "";
            string VT = "";
            string Auto = "";
            string Time = "";
            string Remote = "";
            string PGvaluee = "";
            string PFvaluee = "";
            string PLvaluee = "";
            string VMvaluee = "";
            string LSvaluee = "";
            string CLvaluee = "";

            string CTvaluee = "";
            string VTvaluee = "";
            string parameterValuesString = "";
            string datetimed = "";
            string markers = "[";
            WASA_EMS_Entities db = new WASA_EMS_Entities();
            string q = "select r.ResourceLocation, r.ResourceID, r.CooridatesGoogle, t.TemplateName from tblResource r left join tblTemplate t on r.TemplateID = t.TemplateID  where t.CompanyID = " + c_id + "";
            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
                try
                {
                    conn.Open();
                    SqlCommand cmd3 = new SqlCommand(q, conn);
                    using (SqlDataReader sdr = cmd3.ExecuteReader())
                    {
                        while (sdr.Read())
                        {
                            string q1 = "select distinct r.ResourceLocation,  t.TemplateName, p.ParameterName, e.ParameterValue, e.InsertionDateTime, rms.CurrentMotorOnOffStatus from tblEnergy e ";
                            q1 += "left join tblParameter p on e.ParameterID = p.ParameterID ";
                            q1 += "left join tblResource r on e.ResourceID = r.ResourceID ";
                            q1 += "left join tblRemoteSensor rms on r.ResourceID = rms.ResourceID ";
                            q1 += "left join tblTemplate t on r.TemplateID = t.TemplateID ";
                            q1 += "where e.InsertionDateTime = (select max(InsertionDateTime) from tblEnergy where ResourceID = " + sdr["ResourceID"] + ")";
                            q1 += "and r.ResourceID = " + sdr["ResourceID"] + "";
                            SqlCommand cmd1 = new SqlCommand(q1, conn);
                            int optionStatus = 0;
                            using (SqlDataReader sdr1 = cmd1.ExecuteReader())
                            {
                                while (sdr1.Read())
                                {
                                    string valuee = "";






                                    parameterValuesString += "";
                                    parameterValuesString += sdr1["ParameterName"].ToString() + ": ";

                                    if (sdr1["ParameterName"].ToString() == "Manual")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Auto = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Auto = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus1.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                             P1 = "OFF";
                                        }
                                        else
                                        {
                                            P1 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus2.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P2 = "OFF";
                                        }
                                        else
                                        {
                                            P2 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus3.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P3 = "OFF";
                                        }
                                        else
                                        {
                                            P3 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus4.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P4 = "OFF";
                                        }
                                        else
                                        {
                                            P4 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus5.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P5 = "OFF";
                                        }
                                        else
                                        {
                                            P5 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus6.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P6 = "OFF";
                                        }
                                        else
                                        {
                                            P6 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus7.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P7 = "OFF";
                                        }
                                        else
                                        {
                                            P7 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus8.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P8 = "OFF";
                                        }
                                        else
                                        {
                                            P8 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatus9.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P9 = "OFF";
                                        }
                                        else
                                        {
                                            P9 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PumpStatuss10.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            P10 = "OFF";
                                        }
                                        else
                                        {
                                            P10 = "ON";
                                            optionStatus += 1;
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "CurrentTrip.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "No Error";
                                        }
                                        else
                                        {
                                            valuee = "Error";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "VoltageTrip.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "No Error";
                                        }
                                        else
                                        {
                                            valuee = "Error";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "Remote.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Remote = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Remote = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "TimeSchedule.")
                                    {
                                        if (sdr1["ParameterValue"].ToString() == "0")
                                        {
                                            valuee = "OFF";
                                            Time = "OFF";
                                        }
                                        else
                                        {
                                            valuee = "ON";
                                            Time = "ON";
                                        }
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "Pressure(Bar)")
                                    {
                                        PGvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PF.")
                                    {
                                        PFvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "PrimingLevel")
                                    {
                                        PLvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "vib_y")
                                    {
                                        VMvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "ChlorineLevel.")
                                    {
                                        CLvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "OutdoorLight")
                                    {
                                        LSvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "VoltageTrip.")
                                    {
                                        VTvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else if (sdr1["ParameterName"].ToString() == "CurrentTrip.")
                                    {
                                        CTvaluee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                    else
                                    {
                                        valuee = Math.Round(Convert.ToDouble(sdr1["ParameterValue"]), 2).ToString();
                                    }
                                   

                                    PF += PFvaluee;
                                    PL += PLvaluee;
                                    VM += VMvaluee;
                                    CL += CLvaluee;
                                    LS += LSvaluee;
                                    VT += VTvaluee;
                                    CT += CTvaluee;
                                    parameterValuesString += valuee;
                                    parameterValuesString += "<br />";
                                    datetimed = sdr1["InsertionDateTime"].ToString();
                                    //optionStatus = sdr1["CurrentMotorOnOffStatus"].ToString();
                                }
                            }
                            string theStatus = "False";
                            if (optionStatus > 0)
                            {
                                theStatus = "True";
                            }


                            tempName = sdr["TemplateName"].ToString().Substring(0, 1);

                            string newstring = "<b>" + sdr["TemplateName"].ToString() + "</b>";
                            newstring += "<br />";
                            newstring += "<b>" + sdr["ResourceLocation"].ToString() + "</b>";
                            newstring += "<br />";
                            newstring += datetimed;
                            newstring += "<br />";
                            newstring += parameterValuesString;

                            TimeSpan duration = (Convert.ToDateTime(TimeZoneInfo.ConvertTimeBySystemTimeZoneId(DateTime.UtcNow, "Pakistan Standard Time").ToString()) - Convert.ToDateTime(datetimed.ToString()));
                            double minu = duration.TotalMinutes;
                            parameterValuesString = "";

                            markers += "{";

                            
                            markers += string.Format("'P': '{0}',", PGvaluee);
                            markers += string.Format("'P1': '{0}',", P1);
                            markers += string.Format("'P2': '{0}',", P2);
                            markers += string.Format("'P3': '{0}',", P3);
                            markers += string.Format("'P4': '{0}',", P4);
                            markers += string.Format("'P5': '{0}',", P5);
                            markers += string.Format("'P6': '{0}',", P6);
                            markers += string.Format("'P7': '{0}',", P7);
                            markers += string.Format("'P8': '{0}',", P8);
                            markers += string.Format("'P9': '{0}',", P9);
                            markers += string.Format("'P10': '{0}',", P10);
                            markers += string.Format("'Status': '{0}',", theStatus);
                            markers += string.Format("'Template': '{0}',", tempName);
                            markers += string.Format("'title': '{0}',", sdr["ResourceLocation"]);
                            markers += string.Format("'Dtae': '{0}',", datetimed);
                            //markers += string.Format("'time': '{0}',", sdr1["InsertionDateTime"]);
                            markers += string.Format("'lat':'{0}',", sdr["CooridatesGoogle"].ToString().Split(',')[0]);
                            markers += string.Format("'lnt':'{0}',", sdr["CooridatesGoogle"].ToString().Split(',')[1]);
                            //markers += string.Format("'parameter':'{0}',", sdr1["ParameterName"]);
                            //markers += string.Format("'value':'{0}'", sdr1["ParameterValue"]);
                            markers += string.Format("'DelTime': '{0}',", minu);
                            markers += string.Format("'description': '{0}'", newstring);
                            markers += "},";
                        }
                    }
                    conn.Close();
                }
                catch (Exception ex)
                {

                }
                //return new SelectList(theResourceTypes, "Value", "Text", "id");
            }

            markers += "]";
            return markers;
        }

        [WebMethod]
        public string GetWL230()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
        DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
        //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
        //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
        string scriptString = "";
        string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Well2Level(ft)' ";
    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
    DataTable dtRes1 = new DataTable();
    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
    getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Well2Level(ft)'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
    DataTable dtPar = new DataTable();
    sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

    // scriptString += drPar["ResourceID"];
    // scriptString += drPar["ResourceID"];

    string aquery = ";WITH CTE AS ( ";
    aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
    SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
    DataTable dtVal = new DataTable();
    sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
    DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

datap = JsonConvert.SerializeObject(dataPoints) + "";


// datap += dataPoints;
scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
scriptString = scriptString + "]";
scriptString = scriptString + "}";
scriptString += ");";

                    }
                }

                catch (Exception ex)
{

}
            }
            string NewscripString = datap;
return NewscripString;






        }
       
        [WebMethod]
           public string GetData1()
           {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;


            string scriptString = "";

            string Loc = "";

            string datap = "";
            string markers = "[";
            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
                ////
                ///
                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                          scriptString += "theme: \"light2\",";
                          scriptString += "animationEnabled: true,";
                          scriptString += "zoomEnabled: true, ";
                          scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                          scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                          scriptString += "axisY: {suffix: \" Cusec\" },";
                          //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                          scriptString += "toolTip: { shared: false },";
                          scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                     //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        foreach (DataRow drPar in dtPar.Rows)
                        {
                             scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                           aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                           // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";
                            
                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {
                                // scriptString += drVal["ParameterValue"];
                                // if (dtVal.Rows.IndexOf(drVal) != 0)
                                // {
                                //  dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(dt).AddHours(-5).AddMinutes(1) - new DateTime(1970, 1, 1)).TotalMilliseconds), double.NaN));
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5).AddMinutes(-1) - new DateTime(1970, 1, 1)).TotalMilliseconds), double.NaN));
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                // dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                // }
                                //else
                                //{
                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";
                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                      scriptString += ");";
                        
                      //  markers += "{";

                        
                     //   markers += string.Format("'Data12': '{0}',", scriptString);

                   //  markers += string.Format("'Datau': '{0}'", datap);

                      //  markers += "},";
                    }
                }
                
catch (Exception ex)
{

}
}
          //  string NewscripString = datap;
           string NewscripString = scriptString;
          //   markers += "]";
             // return markers;
             return NewscripString;
            //  ViewData["chartData"] = NewscripString;






        }
       // C2
        [WebMethod]
        public string GetData2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            
            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {
              
                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                             foreach (DataRow drVal in dtVal.Rows)
                              {
                                  
                                  dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                  dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                  //}
                                  //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                              }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                           datap = JsonConvert.SerializeObject(dataPoints) + "";
                            

                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
           string NewscripString = datap;
           return NewscripString;
            





        }
        [WebMethod]
        public string GetV1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVA()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVAR()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKW()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetF()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        /// a3
        [WebMethod]
        public string GetData3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                       //  dataPoints.Max(point1 => point.y);
                           

                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1A3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVA3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARA3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWa3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetF3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // D2 gRAPH
        [WebMethod]
        public string GetDatad2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1d2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVd2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARd2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWd2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetFd2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // E graph
        [WebMethod]
        public string GetDatae1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1e1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVe1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARe1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWe1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetFe1()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // campus graph
        [WebMethod]
        public string GetDatacp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetFcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // F-1 graph
        [WebMethod]
        public string GetDataj()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1j()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVj()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARj()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWj()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetFj()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // jubilee grapp
        [WebMethod]
        public string GetDatajc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetV1jc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVjc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVA.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVA.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKVARjc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKVAR.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKVAR.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetPKWjc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PKW.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PKW.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        [WebMethod]
        public string GetFjc()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'Frequency.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'Frequency.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 10 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 30 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 31 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // water A-3
        [WebMethod]
        public string GetWat()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 A3
        [WebMethod]
        public string GetWat7()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
           DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
           DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 A3
        [WebMethod]
        public string GetWat30()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water C2
        [WebMethod]
        public string GetWatC()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 A3
        [WebMethod]
        public string GetWat7C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 C
        [WebMethod]
        public string GetWat30C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water D
        [WebMethod]
        public string GetWatD()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 D
        [WebMethod]
        public string GetWat7D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 D
        [WebMethod]
        public string GetWat30D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water E
        [WebMethod]
        public string GetWatE()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 E
        [WebMethod]
        public string GetWat7E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 E
        [WebMethod]
        public string GetWat30E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water camp
        [WebMethod]
        public string GetWatcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 camp
        [WebMethod]
        public string GetWat7cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 camp
        [WebMethod]
        public string GetWat30cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water F
        [WebMethod]
        public string GetWatF()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
             DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
             DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
           // DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
           // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 F
        [WebMethod]
        public string GetWat7F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
             // DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
           //  DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
          DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
           DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 F
        [WebMethod]
        public string GetWat30F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
           DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
           DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
          //  DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
          //  DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // water J
        [WebMethod]
        public string GetWat6()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
             DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
             DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
          //  DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
           // DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";

            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 7 F
        [WebMethod]
        public string GetWat7J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
           DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 J
        [WebMethod]
        public string GetWat30J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(10).AddDays(-30).Date;
           DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(10).Date;
             // DateTime FinalTimeTo = DateTime.Now.AddHours(10).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'WaterFlow(Cusec).' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'WaterFlow(Cusec).'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        //mAX i a3
        [WebMethod]
        public string GetDataI()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
       // mAX V A3
        [WebMethod]
        public string GetVmax()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }
        // max v i c2
        [WebMethod]
        public string GetDataIC()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxC()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }
        // max v i d2
        [WebMethod]
        public string GetDataID()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxD()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }

        
        ///  max v and i E
        
        [WebMethod]
        public string GetDataIE()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxE()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }

        ///  max v and i Camp

        [WebMethod]
        public string GetDataIcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxcp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }
        ///  max v and i F
        [WebMethod]
        public string GetDataIF()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxF()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }
        ///  max v and i Jubilee
        [WebMethod]
        public string GetDataIJ()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // mAX V 
        [WebMethod]
        public string GetVmaxJ()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT top 259200 e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 259200 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 259201 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            //  dataPoints.Max(point1 => point.y);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;







        }
        // last 7 and 30 cureet a3
        [WebMethod]
        public string GetI7()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 A3
        [WebMethod]
        public string GetI30()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet c2
        [WebMethod]
        public string GetI7C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 C2
        [WebMethod]
        public string GetI30C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet D2
        [WebMethod]
        public string GetI7D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 D2
        [WebMethod]
        public string GetI30D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet E
        [WebMethod]
        public string GetI7E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 E
        [WebMethod]
        public string GetI30E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet camp
        [WebMethod]
        public string GetI7cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 camp
        [WebMethod]
        public string GetI30cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet F
        [WebMethod]
        public string GetI7F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 F
        [WebMethod]
        public string GetI30F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 7 and 30 cureet J
        [WebMethod]
        public string GetI7J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 J
        [WebMethod]
        public string GetI30J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'I1.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'I1.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 30 and 7 voltage a3
        [WebMethod]
        public string GetV7()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 A3
        [WebMethod]
        public string GetV30()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 30 and 7 voltage  c2
        [WebMethod]
        public string GetV7C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 c2
        [WebMethod]
        public string GetV30C()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 30 and 7 voltage D
        [WebMethod]
        public string GetV7D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 D
        [WebMethod]
        public string GetV30D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // last 30 and 7 voltage E
        [WebMethod]
        public string GetV7E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 E
        [WebMethod]
        public string GetV30E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // last 30 and 7 voltage Camp
        [WebMethod]
        public string GetV7cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 camp
        [WebMethod]
        public string GetV30cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // last 30 and 7 voltage F
        [WebMethod]
        public string GetV7F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 F
        [WebMethod]
        public string GetV30F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // last 30 and 7 voltage F
        [WebMethod]
        public string GetV7j()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            // DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-7).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT  e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }
        // for 30 J
        [WebMethod]
        public string GetV30J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            //  DateTime FinalTimeFrom = DateTime.Now.AddHours(0).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            string scriptString = "";
            string datap = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'V1N.' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'V1N.'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                //}
                                //dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

        // working C 2
        [WebMethod]
        public string GetWH()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
         //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
          //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
              DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
              DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                
                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                   // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }
                                
                              //  t += tim;
                                
                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }
                            
                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";
                            
                                      //var array = t.Split(' ');
                                     //firstElem = array[1];

                                    //Console.WriteLine(datap.Length);


                                    // datap += dataPoints;
                                    scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working C 2 7
        [WebMethod]
        public string GetWH7()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count()*7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working C 2 30
        [WebMethod]
        public string GetWH30()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working A
        [WebMethod]
        public string GetWHA3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working a 7
        [WebMethod]
        public string GetWH7A3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working a 30
        [WebMethod]
        public string GetWH30A3()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[1];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working D
        [WebMethod]
        public string GetWHD()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working d 7
        [WebMethod]
        public string GetWH7D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // workingd 30
        [WebMethod]
        public string GetWH30D()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[2];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working E
        [WebMethod]
        public string GetWHE()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working e 7
        [WebMethod]
        public string GetWH7E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working e 30
        [WebMethod]
        public string GetWH30E()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[3];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working campus
        [WebMethod]
        public string GetWHCp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working camp 7
        [WebMethod]
        public string GetWH7cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working camp 30
        [WebMethod]
        public string GetWH30cp()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[4];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working F
        [WebMethod]
        public string GetWHF()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working f 7
        [WebMethod]
        public string GetWH7F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // working f 30
        [WebMethod]
        public string GetWH30F()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[5];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working j
        [WebMethod]
        public string GetWHJ()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count();
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }

        // working d 7
        [WebMethod]
        public string GetWH7J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 7;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        // workingJ 30
        [WebMethod]
        public string GetWH30J()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";

            string firstElem = "";

            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[6];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);

                                if (drVal["ParameterValue"].ToString() == "1")
                                {
                                    // tim += dt.ToString();
                                    tim += dt.Hour.ToString();
                                    int distinctCount = tim.Distinct().Count() * 30;
                                    t = distinctCount.ToString();
                                    //DateTime dt1 = DateTime.Parse(tim);
                                    //dt1.ToString("HH:mm");
                                }

                                //  t += tim;

                                //datap = JsonConvert.SerializeObject(dataPoints) + "";
                                /* for (int i = 0; i < datap.Length; i++)
                                 {
                                     var YUe = dataPoints[i].y;

                                     if (YUe == 1)
                                     {
                                       tim += dt.ToString();
                                     }
                                     t += tim;
                                 }*/

                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";

                            //var array = t.Split(' ');
                            //firstElem = array[1];

                            //Console.WriteLine(datap.Length);


                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = t;
            return NewscripString;






        }
        [WebMethod]
        public string GetWH2()
        {
            // DateTime FinalTimeFrom = DateTime.Now;
            // DateTime FinalTimeTo = DateTime.Now;
            //   DateTime FinalTimeFrom = DateTime.Now.AddHours(0).AddDays(-30).Date;
            //  DateTime FinalTimeTo = DateTime.Now.AddHours(0).AddDays(1).Date;
            DateTime FinalTimeFrom = DateTime.Now.AddHours(5).Date;
            DateTime FinalTimeTo = DateTime.Now.AddHours(5).AddDays(1).Date;
            string scriptString = "";
            string datap = "";
            string tim = "";
            string t = "";



            using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString))
            {

                try
                {

                    string getResFromTemp = "select ParameterID from tblParameter where parameterName = 'PumpStatus' ";
                    SqlDataAdapter sdaRes = new SqlDataAdapter(getResFromTemp, conn);
                    DataTable dtRes1 = new DataTable();
                    sdaRes.Fill(dtRes1);
                    int ite = 0;
                    foreach (DataRow drRes in dtRes1.Rows)
                    {
                        //string resName = drRes["resourceLocationName"].ToString();
                        ite += 1;
                        string getParamsFromRes = "";
                        getParamsFromRes = "select r.ResourceID, r.ResourceName, rtp.TemplateID from tblResource r inner join tblTemplateParameter rtp on r.TemplateID = rtp.TemplateID inner join tblParameter p on rtp.ParameterID = p.ParameterID where p.ParameterName = 'PumpStatus'   and rtp.TemplateID = 64 order by cast(r.ResourceID as int) asc";
                        SqlDataAdapter sdaPar = new SqlDataAdapter(getParamsFromRes, conn);
                        DataTable dtPar = new DataTable();
                        sdaPar.Fill(dtPar);
                        //  scriptString += "var chart" + ite + " = new CanvasJS.Chart(\"chartContainer" + ite + "\", {";
                        scriptString += "theme: \"light2\",";
                        scriptString += "animationEnabled: true,";
                        scriptString += "zoomEnabled: true, ";
                        scriptString += "title: {text: \"WaterFlow (Cusec)\" },";
                        scriptString += "subtitles: [{text: \" All Tubewells Recent Water Flow  \" }],";
                        scriptString += "axisY: {suffix: \" Cusec\" },";
                        //scriptString += "axisY: {includeZero: false, prefix: \"\", labelFormatter: function(e){if(e.value == NaN){return \"No Data\";}else{return e.value;}} },";
                        scriptString += "toolTip: { shared: false },";
                        scriptString += "legend: { cursor: \"pointer\", itemclick: toogleDataSeries, fontSize: 15},";
                        scriptString += " data: [";
                        //   scriptString +=  dtPar.Rows[1]["ResourceID"];

                        // foreach (DataRow drPar in dtPar.Rows)
                        // {

                        if (dtPar.Rows.Count > 0)
                        {
                            DataRow drPar = dtPar.Rows[0];

                            // scriptString += drPar["ResourceID"];
                            // scriptString += drPar["ResourceID"];

                            string aquery = ";WITH CTE AS ( ";
                            aquery += "SELECT e.ParameterID, e.ParameterValue, e.InsertionDateTime,  ";
                            aquery += " RN = ROW_NUMBER() OVER(PARTITION BY e.ParameterID ";
                            aquery += "ORDER BY e.InsertionDateTime DESC) ";
                            aquery += "FROM tblEnergy e ";
                            aquery += "inner join tblResource r on e.ResourceID = r.ResourceID ";
                            //aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime  > DATE_SUB(NOW(),​INTERVAL 1";
                            aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + Convert.ToInt32(drRes["ParameterID"]) + " and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            // aquery += "WHERE e.ResourceID = " + Convert.ToInt32(drPar["ResourceID"]) + " and e.ParameterID = " + 130 + " or e.ParameterID = " + 118 + "and e.InsertionDateTime >= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeFrom + "', 103), 121) and e.InsertionDateTime <= CONVERT(CHAR(24), CONVERT(DATETIME, '" + FinalTimeTo + "', 103), 121)  ";
                            aquery += ") ";
                            aquery += "SELECT top 1400 ParameterID, ParameterValue, InsertionDateTime FROM CTE WHERE RN < 14401 Order by InsertionDateTime DESC";
                            string theQuery = aquery;
                            SqlDataAdapter sdaVal = new SqlDataAdapter(theQuery, conn);
                            DataTable dtVal = new DataTable();
                            sdaVal.Fill(dtVal);
                            // Loc += drPar["ResourceName"].ToString();
                            scriptString += "{ type: \"area\", name: \"" + drPar["ResourceName"].ToString() + "\", showInLegend: true,  markerSize: 1, xValueType: \"dateTime\", xValueFormatString: \"HH:mm:ss DD-MM-YYYY\", yValueFormatString: \"#,##0.##\", toolTipContent: \"{label}<br/>{name}, <strong>{y} Cusec</strong> at {x}\", ";

                            List<DataPoint> dataPoints = new List<DataPoint>();
                            DateTime dt = DateTime.Now;
                            foreach (DataRow drVal in dtVal.Rows)
                            {

                                dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]).AddHours(-5) - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                                dt = Convert.ToDateTime(drVal["InsertionDateTime"]);
                                datap = JsonConvert.SerializeObject(dataPoints) + "";
                                
                                //}
                                // dataPoints.Add(new DataPoint(Convert.ToDouble((long)(Convert.ToDateTime(drVal["InsertionDateTime"]). - new DateTime(1970, 1, 1)).TotalMilliseconds), Convert.ToDouble(drVal["ParameterValue"])));
                            }

                            scriptString += "dataPoints: " + JsonConvert.SerializeObject(dataPoints) + "";

                            datap = JsonConvert.SerializeObject(dataPoints) + "";



                            // datap += dataPoints;
                            scriptString += "},";
                        }
                        scriptString = scriptString.Remove(scriptString.Length - 1);
                        scriptString = scriptString + "]";
                        scriptString = scriptString + "}";
                        scriptString += ");";

                    }
                }

                catch (Exception ex)
                {

                }
            }
            string NewscripString = datap;
            return NewscripString;






        }

    }
}



