
<!DOCTYPE html>

<html>
<head>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="~/Content/style1.css">
    <link rel="stylesheet" href="~/Content/TubewellDashboard.css" />


    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>

    @*<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>*@



    <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>


    <script type="text/javascript" src="~/Scripts/TubewellDashboard.js"></script>

    @*<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>*@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/0.2.0/Chart.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlT_-WIkJ_8eKmEGZZFOGzugRIHjviICI"
            type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                type: 'GET',
                dataType: 'html',
                url: '_Tubewell',
                cache: false,
                success: function (result) {
                    $('#WelcomeDiv').html(result);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    $('#WelcomeDiv').html("");
                },
                async: true
            });
        });
        //setInterval("$('#DashboardDiagram').load('_DashboardView') ", 2000);
        var refreshId = setInterval(function () {
            var properID = $('#WelcomeDiv').load('_Tubewell');
            console.log('proper id value: ' + parseInt(properID));
            if (properID > 0) {
                clearInterval(refreshId);
            }
        }, 10000);
        //},  200000);
    </script>

    <script type="text/javascript">
        window.onload = function () {
            //alert('on load');
            LoadGoogleMap();
            var refreshId = setInterval(function () {
                document.getElementById("maps").innerHTML = "";
                //alert(refreshId + 'on set interval');
                var properID = LoadGoogleMap();
                if (properID > 0) {
                    clearInterval(refreshId);
                }
            }, 100000);
        }
        function LoadGoogleMap() {
            var markers = GetMapData();
            //   markers = JSON.parse(JSON.parse(markers1));
            // markers = JSON.parse(markers);
            // markers = JSON.parse(JSON.parse(markers));
            //  alert(markers)
            var mapOptions = {
                center: new google.maps.LatLng(31.428300, 74.250978),
                //center: new google.maps.LatLng(markers[0].lat, markers[0].lnt),
                zoom: 11,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var infoWindow = new google.maps.InfoWindow();
            var map = new google.maps.Map(document.getElementById("maps"), mapOptions);

            for (i = 0; i < markers.length; i++) {
                //   alert(markers.length)ss
                var data = markers[i]
                // alert(data)
                var myLatlng = new google.maps.LatLng(data.lat, data.lnt);
                var Status = data.Status;
                var delt = data.DelTime;
                var Letter = data.Template;
                var iconcolor = "";
                //alert(Status);
                //if (Status == "")
                //if (Status == "")
                if (Status == "False" || delt > 100) {
                    //                      iconcolor = new google.maps.MarkerImage(
                    //  'http://www.gettyicons.com/free-icons/108/gis-gps/png/24/needle_left_yellow_2_24.png',
                    //  new google.maps.Size(24, 24),
                    //  new google.maps.Point(0, 0),
                    //  new google.maps.Point(0, 24)
                    //);
                    iconcolor = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=";
                    iconcolor = iconcolor + "";
                    iconcolor = iconcolor + " |FF0000|000000";
                }
                else {
                    iconcolor = "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=";
                    iconcolor = iconcolor + "";
                    iconcolor = iconcolor + " |00FF00|000000";
                }
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                    title: data.title,
                    label: { text: Letter, color: "#000", fontWeight: "bold", fontsize: "8px", labelOrigin: new google.maps.Point(0, 0) },
                    icon: { url: iconcolor, origin: { x: 0, y: 0 } }
                });
                (function (marker, data) {
                    google.maps.event.addListener(marker, "click", function (e) {
                        infoWindow.setContent(data.description);
                        infoWindow.open(map, marker);
                    });
                })(marker, data);

            }
        }

        function GetMapData() {

            var markers = '';

            //   var url = "http://wasalhr.ttlogix.com/savedata.asmx/GetData";
            //  var json = '';
            $.ajax({
                type: "POST",
                url: "../savedata.asmx/GetData",
                data: "{}",

                contentType: "application/json; charset=utf-8",
                dataType: "json",

                async: false,
                success: function (resp) {
                    markers = eval(resp.d);


                },
                error: function () { debugger; }
            });
            return markers;
        }
    </script>

    <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>



</head>
<body>

    <h1>WASA Dashboard</h1>


    <div class="grid-container">
        <div class="card21" id="status" style=" background-color: #e6e6e6 ">
            <h5 class="card-header">TubeWell </h5>
            <div class="row">
                <div class="column">
                    <h5>Site Name</h5>
                    <p id="L1">Some text..</p>
                    <p id="L2">Some text..</p>
                    <p id="L3">Some text..</p>
                    <p id="L4">Some text..</p>
                    <p id="L5">Some text..</p>
                    <p id="L6">Some text..</p>
                    <p id="L7">Some text..</p>
                </div>
                <div class="column">
                    <h5>Status</h5>
                    <p id="S1">Some text..</p>
                    <p id="S2">Some text..</p>
                    <p id="S3">Some text..</p>
                    <p id="S4">Some text..</p>
                    <p id="S5">Some text..</p>
                    <p id="S6">Some text..</p>
                    <p id="S7">Some text..</p>
                </div>
            </div>
        </div>

        <div class="card22" id="Total" style=" background-color: #666666 ">
            <h5 class="card-header2">Total Tubewells </h5>
            <p class="card-text" style="font-size:36px;color:white">7 </p>
        </div>
        <div class="card55" id="Active" style=" background-color: #666666 ">
            <h5 class="card-header1">Active </h5>
            <p class="card-text" id="Act" style="font-size:36px;color:white">Some. </p>
        </div>
        <div class="card56" id="InActive" style=" background-color: #666666 ">
            <h5 class="card-header3">In-Active </h5>
            <p class="card-text" id="InAct" style="font-size:36px;color:white">Some. </p>
        </div>
        <div class="card23" id="maps" style=" background-color: #e6e6e6 " height="200">

        </div>
        <div class="card24" id="chartContainer1">  <canvas id="canvas1" width="150" height="200"></canvas></div>

        <div class="card25" id="siteF" style=" background-color: #e6e6e6 ">
            <h5 class="card-header">Site Filter </h5>
            <div class='dropdown'>
                <div class='title pointerCursor'>Select an option <i class="fa fa-angle-right"></i></div>

                <div class='menu pointerCursor hide' id="option">
                    <div class='option' id='option1'>Option 1</div>
                    <div class='option' id='option2'>Option 2</div>
                    <div class='option' id='option3'>Option 3</div>
                    <div class='option' id='option4'>Option 4</div>
                    <div class='option' id='option5'>Option 4</div>
                    <div class='option' id='option6'>Option 4</div>
                    <div class='option' id='option7'>Option 4</div>
                </div>

            </div>
        </div>
        <div class="card2" id="A" style=" background-color: #FFFFFF ">
            <h5 class="card-header">Manual </h5>
            <p class="card-text" id="A1" style="font-size:28px;">OFF </p>
        </div>
        <div class="card71" id="R" style=" background-color: #FFFFFF  ">
            <h5 class="card-header">Remote </h5>
            <p class="card-text" id="R1" style="font-size:28px;">OFF </p>
        </div>
        <div class="card72" id="T" style=" background-color: #FFFFFF  ">
            <h5 class="card-header">Time Schedule </h5>
            <p class="card-text" id="T1" style="font-size:28px;">ON </p>
        </div>
        <div class="card3" id="VT" style=" background-color: #cccccc">
            <h5 class="card-header"> Voltage Trip</h5>
            <p id="VT1" style="font-size:36px;color:red"> </p>
            <p id="VT2" style="font-size:36px"> </p>
        </div>

        <div class="card4" id="MV" style=" background-color: #cccccc">
            <h5 class="card-header">Max. Voltage</h5>
            <p class="card-text" id="MV1" style="font-size:24px;">230V </p>
        </div>

        <div class="card33" id="IT" style=" background-color: #cccccc">
            <h5 class="card-header"> Current Trip</h5>
            <p id="IT1" style="font-size:36px;color:red"></p>
            <p id="IT2" style="font-size:36px"> </p>
        </div>

        <div class="card44" id="IV" style=" background-color: #cccccc">
            <h5 class="card-header">Max. Current</h5>
            <p class="card-text" id="IV1" style="font-size:24px;">91A</p>
        </div>

        <div class="card26" id="chartl30WH" style=" background-color: #f9c9a8 ">
        </div>

        <div class="card27" id="chartl7WH" style=" background-color: #ebdda1 ">

        </div>

        <div class="card28" id="chartTWH" style=" background-color: #daecee "> </div>



        <div class="card31" id="chartl30WF" style=" background-color:  #f9c9a8 ">
            <h5 class="card-header">Last 30 Days Water Flow </h5>
        </div>

        <div class="card32" id="chartl7WF" style=" background-color: #ebdda1 ">
            <h7 class="card-header">Last 7 Days Water Flow </h7>
        </div>

        <div class="card43" id="chartTWF" style=" background-color: #daecee ">
            <h4 class="card-header">Today Water Flow </h4>
        </div>

        <div class="card5" style=" background-color: #f9c9a8">
            <h5 class="card-header">Last 30 Days Avg. Current</h5>
            <p class="card-text" id="LI30" style="font-size:24px;">45.51A </p>
        </div>

        <div class="card6" style=" background-color: #ebdda1">
            <h5 class="card-header">Last 7 days Avg. Current</h5>
            <p class="card-text" id="LI7" style="font-size:24px;">45.51A </p>
        </div>

        <div class="card7" style=" background-color: #daecee">
            <h5 class="card-header">Today Avg. Current</h5>
            <p class="card-text" id="LIT" style="font-size:24px;">45.51A </p>
        </div>

        <div class="card8" style=" background-color: #f9c9a8">
            <h5 class="card-header">Last 30 Days Avg. Voltage</h5>
            <p class="card-text" id="LV30" style="font-size:24px;">217.87V </p>
        </div>

        <div class="card9" style=" background-color: #ebdda1">
            <h5 class="card-header">Last 7 days Avg. Voltage</h5>
            <p class="card-text" id="LV7" style="font-size:24px;">217.87V  </p>
        </div>

        <div class="card10" style=" background-color: #daecee">
            <h5 class="card-header">Today Avg. Voltage</h5>
            <p class="card-text" id="LVT" style="font-size:24px;">217.87V  </p>
        </div>
        <div class="card11" id="chart" style=" background-color: #f9c9a8">
        </div>

        <div class="card12" id="chartPF" style=" background-color: #ebdda1">
        </div>

        <div class="card13" id="chartVM" style=" background-color: #daecee">
        </div>

        <div class="card14" id="chartPL" style=" background-color: #f9c9a8">
            <h5 class="card-header">Primping Level</h5>
            <p class="card-text" id="PL" style="font-size:28px;">Low </p>
        </div>

        <div class="card15" id="CL1" style=" background-color: #FFFFFF">
            <h5 class="card-header">Chlorine Level</h5>
            <p id="CL" style="font-size:36px">Some text..</p>
        </div>

        <div class="card16" id="LS" style=" background-color: #FFFFFF">
            <h5 class="card-header">Light Status</h5>
            <p id="LS1" style="font-size:36px">Some text..</p>
        </div>

    </div>

</body>

</html>
